# 碳排放监测技术研究文档整合项目

## 项目简介

本项目旨在将仓库中的Word文档（9.30第三版.docx）和PowerPoint演示文稿（9.30.pptx）整合为一份格式规范、内容充实的最终汇报文档。

## 主要特性

- **自动化文档生成**：使用Python脚本自动整合Word和PPT内容
- **格式统一**：段内标号统一为"半角数字+顿号"格式（1、2、3、）
- **内容扩充**：通过添加解释性文字，将文档扩充至约5000中文字符
- **图片整合**：自动从PPT提取图片并添加图注
- **多格式输出**：同时生成DOCX和Markdown两种格式

## 输出文件

1. **主文档**
   - `docs/9.30_整合汇报_最终版.docx` - 可编辑的Word文档
   - `docs/9.30_整合汇报_最终版.md` - 可预览的Markdown文档

2. **图片资源**
   - `docs/assets/9.30/` - 从PPT提取的图片文件

## 本地复现步骤

### 环境要求

- Python 3.7+
- pip

### 安装依赖

```bash
pip install -r requirements.txt
```

### 运行脚本

```bash
python scripts/build_report.py
```

### 输出说明

脚本执行后会：
1. 从PPT中提取图像并保存到 `docs/assets/9.30/`
2. 解析Word文档内容
3. 统一段内编号格式为"数字+顿号"
4. 添加扩展性内容达到目标字数
5. 生成最终的DOCX和Markdown文档

## 技术实现

### 依赖库

- `python-docx`: 处理Word文档
- `python-pptx`: 处理PowerPoint文件
- `Pillow`: 图像处理
- `lxml`: XML解析

### 核心功能

1. **标号统一**：使用正则表达式将各种编号格式（1. / 1) / (1) / （1））统一替换为"数字、"
2. **内容扩充**：在适当位置插入解释性段落，使文档达到5000字符左右
3. **图片提取**：从PPT的每一页提取嵌入的图片
4. **PPT内容整合**：将PPT的文本内容添加到文档附录中

## 验收标准

- ✓ 文档字符数在4500-5500之间
- ✓ 段内编号统一为"数字、"格式
- ✓ 包含多张图片且每张都有图注
- ✓ Markdown文件可在GitHub正确显示
- ✓ DOCX文件可正常打开且格式正确

## 文档结构

生成的文档包含以下章节：

1. 第一章 研究背景与意义
2. 第二章 研究思路与技术路线
3. 第三章 研究内容：典型行业监测模型构建
4. 第四章 研究结果
5. 附录：PPT要点补充

## 注意事项

- 原始文件（9.30第三版.docx 和 9.30.pptx）不会被修改
- 脚本会自动创建必要的目录结构
- 所有图片都会转换为PNG格式
- 扩展内容不会改变原文的核心观点和数据

## 许可证

本项目仅用于学术和研究目的。
